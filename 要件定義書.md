- サイト名: 渋谷フリータイム
- キャッチフレーズ: 無料でこんなに楽しめる！渋谷の隠れた魅力を発見

### 概要

渋谷区内にある無料で利用できる場所やサービスをまとめたwebサイトを作成する。webサイトでは常に無料で利用できる場所に限定せず、期間限定で無料の場所やサービスなども掲載する。
例: 無料のコンサートやイベントなど

### 目的

- 渋谷区内の無料で楽しめるスポットやサービスを一元的に提供し、ユーザーの利便性を高める。
- 期間限定の無料イベント情報を提供し、ユーザーの新たな発見や体験を促進する。
- 渋谷区の地域活性化に寄与する。

### ターゲット

- 渋谷(渋谷区)で遊びたいけど使えるお金が少ない人
- 渋谷(渋谷区)で無料で利用できる休憩やリラックスができる場所を求めている人
- 期間限定のイベントやサービスに関心がある人

### 現状の課題(問題点)

- 期間限定で無料の場所やサービスの情報収集方法
  - 効率的な情報収集と正確性の維持が難しい
- 収集した情報をウェブサイトに反映させる方法
  - 情報更新と管理が必要

### 機能要件

1. 情報掲載機能

- 常時無料の場所やサービスの一覧表示。
- 期間限定の無料イベントやサービスの一覧表示。
- カテゴリ、場所、日時などでのフィルタリング機能。

2. 検索機能

- キーワード検索によるスポットやイベントの検索。
  - 時間がないので後回し

3. 詳細ページ

- 各スポットやイベントの詳細情報（場所、時間、内容、アクセス方法など）の表示。
  - 最優先事項

4. マップ連携

- 地図上での場所の表示と経路案内。
- `Google Maps API`を利用して地図を表示。
  - 最低限、住所を表示する。
  - それ以外は後回し

5. 管理者用画面（バックエンド管理）

- ログイン機能
- 管理者のみがアクセス可能なログイン画面を用意。
- `Supabase Auth`を利用して認証を実装。
- 情報管理機能
- 掲載済みの情報の編集・削除。
- 新規情報の手動入力と公開設定。
- 自動収集された情報の下書き保存。
- 自動収集情報の管理
- 自動収集された期間限定情報を下書きとして保存。
- 下書き情報の編集、削除、掲載の選択が可能。
- 編集後、「掲載する」または「下書きとして保存」を選択可能。

### 非機能要件

1. ユーザビリティ

- 直感的で使いやすいインターフェース。
- レスポンシブデザインに対応させる

2. セキュリティ

- 「リスクと対応策」で詳細を記載

3. パフォーマンス

- ページの読み込み速度を高速化。
- CDNを利用する。

## 開発言語・フレームワーク・ツール

### フロントエンド(エンドユーザー向け画面)

- 言語
  - TypeScript
- フレームワーク
  - NextJS
- スタイリング
  - Tailwind CSS
- ホスティング
  - Vercel
- ログイン機能なし
  - 理由: 時間がない。
- マップ連携
  - `Google Maps API`を利用して地図を表示。
- デザイン
  - 過去に自作したコードを元に改変する。

### バックエンド(管理者用画面)

- 使用サービス
  - Supabase
- 認証・認可
  - `Supabase Auth`を使用し、管理者のみがアクセス可能な認証機能を実装。
- データベース
  - Supabaseの提供するPostgreSQLを利用。
- 常時無料の場所の情報管理
  - `Newt CMS`を利用して情報を管理。
  - 期間限定情報の収集と反映方法
- 情報収集方法
  - Webスクレイピングや外部APIを用いて自動収集。
  - 自動収集された情報は下書きとして保存。
- 管理者用画面での対応
  - 管理者は下書き状態の情報を確認し、編集・削除・掲載の判断を行う。
  - 編集後は「掲載する」または「下書きとして保存」を選択可能。
- 言語
  - TypeScript
- スタイリング
  - Tailwind CSS
- ホスティング
  - Vercel

### 「管理者用画面」と「エンドユーザー向け画面」の共通事項

- 「管理者用画面」と「エンドユーザー向け画面」は別のURLでアクセス可能。
- 管理者用画面は`Supabase Auth`を利用して認証を実装。
- 管理者用画面での情報管理は`Supabase`と`Newt CMS`を利用。
- 管理者画面が2つあることになる。
- OGPについて
- SupabaseではJSON形式でコードを指定する。
  - その上で以下のように指定する。

```typescript
export type OGPMetadata = {
  title: string;
  description: string;
  ogImage: string;
};
```

- 補足: `ogImage`は`Supabase Storage`に保存し、画像のURLを指定する。

### リスクと対応策

- 情報の正確性
  - 管理者による情報確認と編集を徹底。
- 情報収集の法的問題
  - スクレイピングやAPI利用時の利用規約・著作権の確認。
- セキュリティリスク
  - 基本的にリスク移転で対応する。
    - SSLを使用する。
    - 認証と認可は`Supabase Auth`に依存する。
    - SupabaseでRLSの設定。

### その他

- ユーザーログイン機能
  - エンドユーザー向けのログイン機能は実装しない。
  - お気に入り機能などは将来的な実装とする。
- `Newt CMS`とSupabaseは連携させない。
  - `Newt CMS`とSupabaseは別々に管理します。
- 管理者用画面はSupabaseと連携させる。
  - 管理者用画面は`Supabase Auth`を利用して認証を実装。
  - 管理者用画面での情報管理はSupabaseのDBを利用。
  - 将来的に拡張が簡単な設計にしておく。

## 現状の問題

### 開発リソースが限られている

- アーキテクチャ
  - できる限りシンプルな仕組みを採用し、開発リソースを最大限に活用する。
- コードのモジュール化
  - 機能やUIごとにコードを分割し、再利用性を高くする。

### スクレイピング対象サイトの選定

- 収集したデータをSupabaseに効率的に保存する方法を設計する。
- `robots.txt`を確認し、スクレイピングが許可されているか確認する。
- 利用規約を確認し、スクレイピングが禁止されていないか確認する。
- `Supabase edge function`を利用して自動的にデータを登録するスクリプトを作成する。
  - `Supabase edge function`が利用できない場合はDenoかNode.jsでスクリプトを作成する。
- コア機能では無いため、後回しで対応する。

### 「今後の展望」としてロードマップに書く機能

- エンドユーザー向けに今後に追加する機能
  - アカウント管理機能
    - アカウント登録時に以下の情報を登録する
      - メールアドレス
      - パスワード
      - ユーザー名
    - アカウント登録後にできる事
      - アカウント登録時に登録した情報の修正
      - アカウントの削除
      - クーポンの配布
      - 投票機能の利用
      - 表示されている中で全ての場所やイベントに対して「お気に入り登録」ができる
      - 期間限定のイベントに対して「参加登録」ができる
        - 参加登録した場合に以下の内容のメール送信する(アカウント登録時に登録されたメールアドレスに対して送信する)
          - 参加登録したイベントのタイトル
          - 参加登録したイベントの詳細
            - 参加登録したイベントの開始日時と終了日時
            - 参加登録したイベントの場所
          - GoogleカレンダーやIOSのデフォルトのカレンダーアプリに日時を登録できるリンク

- バックエンド、管理者向けの画面で将来的に追加、変更する機能
  - データ管理をSupabaseに統一する(Newt cmsの利用をやめる)
  - Supabase edgh fanctionを利用してデータの取得をする
